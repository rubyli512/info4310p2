<html>

<head>
    <title>INFO 4310 Project 2</title>
    <meta charset="UTF-8">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
</head>
<!-- css style for gridlines -->
<style>
    .gridlines line {
        stroke: rgb(223, 223, 223);
    }

    .gridlines .domain {
        stroke: none;
    }
</style>

<svg id="graph" width="800 " height="800" style="margin: 20px"></svg>

<script>

    // select and set canvas
    const graph = d3.select("svg#graph");
    const margins = { top: 10, right: 10, bottom: 40, left: 40 };
    const width = graph.attr("width");
    const height = graph.attr("height");
    const graphWidth = width - margins.left - margins.right;
    const graphHeight = height - margins.top - margins.bottom;


    const getData = async function () {

        // create 3 scales
        let hoursExtent = d3.extent(data, d => d.date)
        let hoursScale = d3.scaleTime().domain(dateExtent).range([0, graphWidth]);
        let outputExtent = d3.extent(data, d => d.age)
        let outputScale = d3.scaleLinear().domain(ageExtent).range([graphHeight, 0]);
        let employScale = d3.scaleOrdinal(d3.schemeCategory10);

        // populate the axis
        let leftAxis = d3.axisLeft(outputScale);
        let bottomAxis = d3.axisBottom(hoursScale);

        // populate gridlines
        let leftGridlines = d3.axisLeft(outputScale).tickFormat('').tickSize(-graphWidth - 10);
        let bottomGridlines = d3.axisBottom(hoursScale).tickFormat('').tickSize(-graphHeight - 10);

        // create 5 g elements    
        graph.append("g").attr("transform", `translate(${margins.left - 10},${margins.top})`).attr("class", "axis").call(leftAxis);
        graph.append('g').attr("transform", `translate(${margins.left},${margins.top + graphHeight + 10})`).attr("class", "axis").call(bottomAxis);
        graph.append('g').attr("transform", `translate(${margins.left - 10},${margins.top})`).attr('class', 'gridlines').call(leftGridlines);
        graph.append('g').attr("transform", `translate(${margins.left},${graphHeight + margins.top + 10})`).attr('class', 'gridlines').call(bottomGridlines);
        let chartArea = graph.append('g').attr("transform", `translate(${margins.left},${margins.top})`).attr("class", "chart");

        // append new circles to chart
        chartArea.selectAll("circle").data(data).join("circle").attr("fill", "lightblue").attr("cx", d => hoursScale(d.date) + jitter()).attr("cy", d => outputScale(d.age)).attr("r", d => employScale(d.employment)).attr("opacity", 0.8)




    }

    // call the function
    getData();

</script>

<body>

</body>

</html>